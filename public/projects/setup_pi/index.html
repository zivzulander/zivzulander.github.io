<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[Matt Morris]">
<meta name="description" content="Installing the OS to an SD Card Install the Raspberry Pi Imager. Under CHOOSE OS select Raspberry Pi OS (Other) and Raspberry Pi OS Lite (64-bit). Click the settings cog to setup wifi, enable ssh, change the default password and change locale settings. Under CHOOSE STORAGE select your inserted sd card.
Find your pi&amp;rsquo;s ip address Raspberry Pi Documentation - Remote Access Boot up the pi and find your new ip address." />
<meta name="keywords" content=", linux, raspberrypi, tutorial" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://mattmorris.ca/projects/setup_pi/" />


    <title>
        
            Setup Your Raspberry Pi :: matt morris  — my personal website
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Setup Your Raspberry Pi">
<meta itemprop="description" content="Installing the OS to an SD Card Install the Raspberry Pi Imager. Under CHOOSE OS select Raspberry Pi OS (Other) and Raspberry Pi OS Lite (64-bit). Click the settings cog to setup wifi, enable ssh, change the default password and change locale settings. Under CHOOSE STORAGE select your inserted sd card.
Find your pi&rsquo;s ip address Raspberry Pi Documentation - Remote Access Boot up the pi and find your new ip address.">

<meta itemprop="wordCount" content="768"><meta itemprop="image" content="https://mattmorris.ca"/>
<meta itemprop="keywords" content="linux,raspberrypi,tutorial," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://mattmorris.ca"/>

<meta name="twitter:title" content="Setup Your Raspberry Pi"/>
<meta name="twitter:description" content="Installing the OS to an SD Card Install the Raspberry Pi Imager. Under CHOOSE OS select Raspberry Pi OS (Other) and Raspberry Pi OS Lite (64-bit). Click the settings cog to setup wifi, enable ssh, change the default password and change locale settings. Under CHOOSE STORAGE select your inserted sd card.
Find your pi&rsquo;s ip address Raspberry Pi Documentation - Remote Access Boot up the pi and find your new ip address."/>



    <meta property="og:title" content="Setup Your Raspberry Pi" />
<meta property="og:description" content="Installing the OS to an SD Card Install the Raspberry Pi Imager. Under CHOOSE OS select Raspberry Pi OS (Other) and Raspberry Pi OS Lite (64-bit). Click the settings cog to setup wifi, enable ssh, change the default password and change locale settings. Under CHOOSE STORAGE select your inserted sd card.
Find your pi&rsquo;s ip address Raspberry Pi Documentation - Remote Access Boot up the pi and find your new ip address." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mattmorris.ca/projects/setup_pi/" /><meta property="og:image" content="https://mattmorris.ca"/><meta property="article:section" content="projects" />

<meta property="og:site_name" content="matt morris" />
















    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__text">matt morris</span>
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/mainpage/about">about</a></li><li><a href="/mainpage/music">music</a></li><li><a href="/mainpage/other">other</a></li><li><a href="/mainpage/contact">contact</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://mattmorris.ca/projects/setup_pi/">Setup Your Raspberry Pi</a></h2>

            
            
            

            <div class="post-content">
                <h2 id="installing-the-os-to-an-sd-card">Installing the OS to an SD Card</h2>
<p>Install the <a href="https://www.raspberrypi.com/software/">Raspberry Pi Imager</a>. Under <em>CHOOSE OS</em> select <em>Raspberry Pi OS (Other)</em> and <em>Raspberry Pi OS Lite (64-bit)</em>. Click the settings cog to setup wifi, enable ssh, change the default password and change locale settings. Under <em>CHOOSE STORAGE</em> select your inserted sd card.</p>
<figure><img src="/blog-images/rpi-imager.png"/>
</figure>

<h2 id="find-your-pi-s-ip-address">Find your pi&rsquo;s ip address</h2>
<p><a href="https://www.raspberrypi.com/documentation/computers/remote-access.html#ip-address">Raspberry Pi Documentation - Remote Access</a>
Boot up the pi and find your new ip address. There are a few ways to do this:</p>
<ul>
<li>Using the <a href="https://github.com/adafruit/Adafruit-Pi-Finder/">Adafruit-Pi-Finder</a>.</li>
<li>using <code>nmap -sn 10.0.0.1/24 | grep -Po '(?&lt;=Nmap scan report for ).*'</code>
Replace <code>10.0.0.1/24</code> with your local network&rsquo;s range.</li>
<li>you can also try to ping your pi using its hostname <code>ping raspberrypi</code></li>
</ul>
<h2 id="first-steps">First steps</h2>
<p>Once you have your pi booted up and ssh&rsquo;d into it you&rsquo;ll want to update your pi (may take a while).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update <span style="color:#f92672">&amp;&amp;</span> sudo apt upgrade -y
</span></span></code></pre></div><p>Let&rsquo;s set up a <code>crontab</code> so this runs once a week.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>crontab -e
</span></span></code></pre></div><p>Adding this line to the end of this file runs the command at 4:30am every Tuesday. If you want to change this time you can check some other crontab options <a href="https://crontab.guru/">here</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">4</span> * * <span style="color:#ae81ff">2</span> sudo apt update <span style="color:#f92672">&amp;&amp;</span> sudo apt upgrade -y
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">19</span> * * sudo apt autoremove <span style="color:#75715e"># removes unused packages to free up space on the 19th of each month</span>
</span></span></code></pre></div><h2 id="mount-usb-hard-drive">Mount USB hard drive</h2>
<h3 id="mount-your-hard-drive">Mount your hard drive</h3>
<p>Find the device you want to mount.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>lsblk -f
</span></span></code></pre></div><p>Which outputs something like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>NAME        FSTYPE FSVER LABEL  UUID                                 FSAVAIL FSUSE% MOUNTPOINT
</span></span><span style="display:flex;"><span>sda
</span></span><span style="display:flex;"><span>└─sda1      ext4   1.0          6f9a255b-d43f-4877-94e9-4c6aacfcce7b  559.1G    80%
</span></span><span style="display:flex;"><span>mmcblk0
</span></span><span style="display:flex;"><span>├─mmcblk0p1 vfat   FAT32 boot   C839-E506                               203M    19% /boot
</span></span><span style="display:flex;"><span>└─mmcblk0p2 ext4   1.0   rootfs 568caafd-bab1-46cb-921b-cd257b61f505     10G    26% /
</span></span></code></pre></div><p>For me it&rsquo;s <code>sda1</code>  on the 2nd line so we use <code>/dev/sda1</code> (it will always be <code>/dev/sdX</code> followed by a number where X is a lowercase letter). Copy this UUID which we&rsquo;ll use in a sec.</p>
<h3 id="format-the-drive--skip-to-mount-the-usb-drive--org695ee01--if-you-don-t-need-this">Format the drive (skip to <a href="#mount-the-usb-drive">Mount the usb drive</a> if you don&rsquo;t need this)</h3>
<p>It&rsquo;s always good to start with a fresh drive and it will be a lot easier if it&rsquo;s not formatted for a macos or Windows filesystem.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo fdisk /dev/sdX
</span></span></code></pre></div><p>This runs the <code>fdisk</code> program which is the easiest way to do this. Pressing <code>m</code> and hitting enter shows the basic commands. The important ones for us are:</p>
<table>
<thead>
<tr>
<th>d</th>
<th>delete a partition</th>
</tr>
</thead>
<tbody>
<tr>
<td>n</td>
<td>add a new partition</td>
</tr>
<tr>
<td>w</td>
<td>write table to disk and exit</td>
</tr>
</tbody>
</table>
<p>Press <code>d</code> to delete any partitions. If there&rsquo;s only 1 it will delete it, if there are more than one it will ask which one to delete. Delete the rest if there are any.</p>
<p>Press <code>n</code> to add a new partition. It will ask various questions like</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Partition number <span style="color:#f92672">(</span>1-128, default 1<span style="color:#f92672">)</span>:
</span></span></code></pre></div><p>Which means the default is <strong>1</strong> and if we just press enter we are accepting the default. Do this for each question. It may also say something about an ext4 or Windows signature that will be removed. You likely don&rsquo;t need this so say yes to remove it.</p>
<p>Press <code>w</code> to save and quit. This will obviously erase everything on this disk so make sure you didn&rsquo;t run <code>fdisk</code> on the wrong disk.</p>
<p>Use <code>lsblk -f</code> to see the formatted drive and get its UUID.</p>
<h3 id="mount-the-usb-drive">Mount the usb drive</h3>
<p>Create a folder on your SD card to mount the drive. Here I&rsquo;m using /mnt/usb.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir /mnt/usb <span style="color:#f92672">&amp;&amp;</span> sudo mount /dev/sda1 /mnt/usb
</span></span></code></pre></div><p>Set the disk to mount after a reboot. Start by getting this new drive&rsquo;s UUID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>lsblk -f /dev/sdX
</span></span></code></pre></div><p>Open <code>fstab</code> in a text editor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -e /etc/fstab
</span></span></code></pre></div><p>When you&rsquo;re done editing press <code>Ctrl-S</code> to save and <code>Ctrl-X</code> to quit.</p>
<p>Add the following with your drive&rsquo;s UUID copied from before.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>UUID<span style="color:#f92672">=</span>YOUR-UUID	/mnt/usb	ext4	defaults	0	<span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h2 id="secure-ssh">Secure SSH</h2>
<p>You probably don&rsquo;t want to have to type in your password each time plus ssh keys are more secure. Type the following on your host.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-copy-id YOUR-PI<span style="color:#960050;background-color:#1e0010">&#39;</span>S-IP-ADDRESS
</span></span></code></pre></div><p>Then change the following line in /etc/ssh/sshd_config</p>
<h2 id="installing-manually">Installing manually</h2>
<p>Download the image</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget gg
</span></span></code></pre></div><h3 id="enable-ssh">Enable ssh</h3>
<p>Fine the <code>boot</code> drive and mount it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>lsblk
</span></span></code></pre></div><p>gives an output like</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ae81ff">0</span>  113G  <span style="color:#ae81ff">0</span> disk
</span></span><span style="display:flex;"><span>├─sda1          8:1    <span style="color:#ae81ff">0</span>  511M  <span style="color:#ae81ff">0</span> part  /boot
</span></span><span style="display:flex;"><span>├─sda2          8:2    <span style="color:#ae81ff">0</span> 19.5G  <span style="color:#ae81ff">0</span> part  /
</span></span><span style="display:flex;"><span>└─sda3          8:3    <span style="color:#ae81ff">0</span>   93G  <span style="color:#ae81ff">0</span> part
</span></span><span style="display:flex;"><span>  └─ainstsda3 254:0    <span style="color:#ae81ff">0</span>   93G  <span style="color:#ae81ff">0</span> crypt /home
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ae81ff">1</span> 14.5G  <span style="color:#ae81ff">0</span> disk
</span></span><span style="display:flex;"><span>├─sdb1          8:17   <span style="color:#ae81ff">1</span>  256M  <span style="color:#ae81ff">0</span> part
</span></span><span style="display:flex;"><span>└─sdb2          8:18   <span style="color:#ae81ff">1</span>  1.6G  <span style="color:#ae81ff">0</span> part  /mnt
</span></span><span style="display:flex;"><span>zram0         253:0    <span style="color:#ae81ff">0</span>  3.9G  <span style="color:#ae81ff">0</span> disk  <span style="color:#f92672">[</span>SWAP<span style="color:#f92672">]</span>
</span></span></code></pre></div><p><code>sbd</code> is my SD card and <code>sdb2</code>, the larger partition is where the boot folder is.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mount /dev/sdb2 /mnt
</span></span><span style="display:flex;"><span>touch /mnt/boot/ssh
</span></span><span style="display:flex;"><span>sudo umount /dev/sdb2
</span></span></code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://mattmorris.ca/tags/linux/">linux</a></span>
        <span class="tag"><a href="https://mattmorris.ca/tags/raspberrypi/">raspberrypi</a></span>
        <span class="tag"><a href="https://mattmorris.ca/tags/tutorial/">tutorial</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.feebdc8d801e3fb1791305e362b6d11557f029604dd5b3c27e2686bc88787ee90ae1ccf0afe81bd7d959d7617cfe1fc73062aa82b4e1fa830d6941193d2cbddf.js" integrity="sha512-/uvcjYAeP7F5EwXjYrbRFVfwKWBN1bPCfiaGvIh4fukK4czwr&#43;gb19lZ12F8/h/HMGKqgrTh&#43;oMNaUEZPSy93w=="></script>



    </body>
</html>
